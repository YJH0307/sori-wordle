<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>소리워들</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700;900&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; padding: 20px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: flex-start;
      min-height: 100vh;
      font-family: 'Noto Sans KR', sans-serif;
    }
    body.light { background: #fff; color: #000; }
    body.dark { background: #121213; color: #eee; }

    h1 { font-size: 40px; font-weight: 900; margin: 10px; }

    .controls { margin: 10px; text-align: center; }
    .controls button {
      font-size: 16px; margin: 0 5px; padding: 8px 14px;
      border: none; border-radius: 6px; cursor: pointer;
    }
    body.light .controls button, body.light #shareBtn { background: #eee; color: #000; }
    body.dark  .controls button, body.dark #shareBtn { background: #ddd; color: #000; }

    .board { display: grid; grid-template-rows: repeat(6, 1fr); gap: 5px; margin: 20px auto; width: max-content; }
    .row { display: grid; gap: 5px; }
    .cell {
      width: 45px; height: 45px; border: 2px solid #ccc;
      display: flex; justify-content: center; align-items: center;
      font-size: 22px; font-weight: bold;
    }
    .correct { background: #6aaa64; color: white; }
    .present { background: #c9b458; color: white; }
    .absent  { background: #787c7e; color: white; }
    body.dark .cell { border-color: #3a3a3c; }
    body.dark .correct { background: #538d4e; }
    body.dark .present { background: #b59f3b; }
    body.dark .absent  { background: #3a3a3c; }

    #shareBtn { display: none; }

    /* === 키보드 === */
    #keyboard { display: grid; gap: 6px; width: 100%; max-width: 500px; margin: 20px auto; }
    .key-row {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 6px;
    }
    .key {
      padding: 12px 0;
      font-size: 18px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      user-select: none;
      background: #ddd;
    }
    .key.wide { grid-column: span 2; } /* 특수 키는 넓게 */
    .key.active { background: #888; color: #fff; }
    body.dark .key.active { background: #bbb; color: #000; }

    body.light .key { background: #ddd; color: #000; }
    body.dark  .key { background: #444; color: #fff; }
    .key.correct { background: #6aaa64; color: #fff; }
    .key.present { background: #c9b458; color: #fff; }
    .key.absent  { background: #3a3a3c; color: #fff; }

    /* 모바일 반응형 */
    @media (max-width: 480px) {
      .cell { width: 36px; height: 36px; font-size: 18px; }
      .key { font-size: 16px; padding: 10px 0; }
    }
  </style>
</head>
<body class="light">
  <h1>소리워들</h1>
  <div class="controls">
    <button onclick="alert('통계 보기 준비중')">통계 보기</button>
    <button id="themeBtn" onclick="toggleTheme()">🌙 다크 모드</button>
  </div>

  <div class="board" id="board"></div>

  <div class="controls">
    <button id="shareBtn" onclick="shareResult()">공유하기</button>
  </div>

  <div id="keyboard"></div>

  <script>
    // === 테마 ===
    function loadTheme() {
      const t = localStorage.getItem('sori-wordle-theme') || 'light';
      document.body.className = t;
      document.getElementById('themeBtn').textContent =
        t === 'light' ? '🌙 다크 모드' : '☀️ 라이트 모드';
    }
    function toggleTheme() {
      const cur = document.body.className === 'light' ? 'dark' : 'light';
      document.body.className = cur;
      localStorage.setItem('sori-wordle-theme', cur);
      loadTheme();
    }
    loadTheme();

    // === 단어 목록 (간단히 고정, 추후 Google Sheets 연동 가능) ===
    const fallbackWords=["가나다","한글"];
    let 정답 = fallbackWords[0];
    let 정답낱자 = [...정답];
    const maxRows = 6;
    let currentRow=0, currentCol=0, gameOver=false;
    let currentGuess=[];
    let shiftOn=false;

    // === 보드 초기화 ===
    function initGame(){
      const board=document.getElementById("board");
      board.innerHTML="";
      for(let r=0;r<maxRows;r++){
        const row=document.createElement("div"); row.className="row";
        row.style.gridTemplateColumns=`repeat(${정답낱자.length},45px)`;
        for(let c=0;c<정답낱자.length;c++){
          const cell=document.createElement("div"); cell.className="cell";
          row.appendChild(cell);
        }
        board.appendChild(row);
      }
      buildKeyboard();
    }

    // === 키보드 ===
    function buildKeyboard(){
      const keyboardRows = [
        ["ㅂ","ㅈ","ㄷ","ㄱ","ㅅ","ㅛ","ㅕ","ㅑ","ㅐ","ㅔ"],
        ["ㅁ","ㄴ","ㅇ","ㄹ","ㅎ","ㅗ","ㅓ","ㅏ","ㅣ"],
        ["Shift","ㅋ","ㅌ","ㅊ","ㅍ","ㅠ","ㅜ","ㅡ","←","Enter"]
      ];
      const keyDiv=document.getElementById("keyboard"); keyDiv.innerHTML="";
      keyboardRows.forEach(rowKeys=>{
        const rowDiv=document.createElement("div"); rowDiv.className="key-row";
        rowKeys.forEach(k=>{
          const keyBtn=document.createElement("div");
          keyBtn.className="key"; keyBtn.textContent=k;
          if(k==="Shift") keyBtn.classList.add("shift-key");
          if(["Enter","Shift","←"].includes(k)) keyBtn.classList.add("wide");
          keyBtn.onclick=()=>handleKey(k);
          rowDiv.appendChild(keyBtn);
        });
        keyDiv.appendChild(rowDiv);
      });
    }

    // === 키 입력 ===
    function handleKey(k){
      if(gameOver) return;

      if(k==="Shift"){
        shiftOn=!shiftOn;
        const shiftKey=document.querySelector(".key.shift-key");
        if(shiftOn) shiftKey.classList.add("active");
        else shiftKey.classList.remove("active");
        return;
      }

      if(shiftOn){
        const map={"ㅂ":"ㅃ","ㅈ":"ㅉ","ㄷ":"ㄸ","ㄱ":"ㄲ","ㅅ":"ㅆ"};
        if(map[k]) { k=map[k]; }
        shiftOn=false;
        document.querySelector(".key.shift-key").classList.remove("active");
      }

      if(k==="Enter"){
        if(currentCol===정답낱자.length) submitGuess();
      } else if(k==="←"){
        if(currentCol>0){
          currentCol--; currentGuess.pop();
          document.getElementById("board").children[currentRow].children[currentCol].textContent="";
        }
      } else {
        if(currentCol<정답낱자.length){
          currentGuess.push(k);
          document.getElementById("board").children[currentRow].children[currentCol].textContent=k;
          currentCol++;
        }
      }
    }

    // === 제출 ===
    function submitGuess(){
      const guess낱자=[...currentGuess];
      if(guess낱자.length!==정답낱자.length) return;
      const row=document.getElementById("board").children[currentRow].children;
      for(let i=0;i<정답낱자.length;i++){
        if(guess낱자[i]===정답낱자[i]){
          row[i].classList.add("correct");
        } else if(정답낱자.includes(guess낱자[i])){
          row[i].classList.add("present");
        } else {
          row[i].classList.add("absent");
        }
      }
      if(guess낱자.join("")===정답낱자.join("")){
        alert("정답! 🎉");
        gameOver=true;
        document.getElementById("shareBtn").style.display="inline-block";
      }
      currentRow++; currentCol=0; currentGuess=[];
      if(currentRow>=maxRows && !gameOver){
        alert("실패! 정답은 "+정답);
        gameOver=true;
        document.getElementById("shareBtn").style.display="inline-block";
      }
    }

    // === 공유 ===
    function shareResult(){
      navigator.clipboard.writeText("소리워들 결과").then(()=>alert("결과가 복사되었습니다!"));
    }

    initGame();
  </script>
</body>
</html>
